name: Build Zephyr for Pi Zero 2

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          path: app

      - name: Setup Zephyr
        uses: zephyrproject-rtos/action-zephyr-setup@v1
        with:
          app-path: app
          # We point specifically to the file we just created
          manifest-path: app/west.yml
          toolchains: zephyr-sdk-arm64 # Note the arm64 toolchain

      - name: Build Firmware
        run: |
          # Use rpi_4b as the board target for the Zero 2 (Cortex-A53)
          west build -p always -b rpi_4b app/ 

      - name: Upload Kernel Image
        uses: actions/upload-artifact@v4
        with:
          name: zephyr-kernel
          path: build/zephyr/zephyr.bin
